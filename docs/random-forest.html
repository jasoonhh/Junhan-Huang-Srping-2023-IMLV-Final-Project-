<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Random Forest | Credit Crad Default Prediction</title>
  <meta name="description" content="Chapter 5 Random Forest | Credit Crad Default Prediction" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Random Forest | Credit Crad Default Prediction" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Random Forest | Credit Crad Default Prediction" />
  
  
  

<meta name="author" content="Junhan Huang" />


<meta name="date" content="2023-05-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="decision-tree.html"/>
<link rel="next" href="reflections.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">CCDP</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Proposal</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#motivation"><i class="fa fa-check"></i><b>1.1</b> Motivation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data"><i class="fa fa-check"></i><b>1.2</b> Data</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#models"><i class="fa fa-check"></i><b>1.3</b> Models</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#modeling-goal"><i class="fa fa-check"></i><b>1.4</b> Modeling Goal</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>2</b> Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="2.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#the-structure-of-dataset"><i class="fa fa-check"></i><b>2.1</b> The Structure of Dataset</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#data-identification"><i class="fa fa-check"></i><b>2.1.1</b> Data Identification</a></li>
<li class="chapter" data-level="2.1.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#feature-problem-detection"><i class="fa fa-check"></i><b>2.1.2</b> Feature Problem Detection</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#data-visualization-analysis"><i class="fa fa-check"></i><b>2.2</b> Data Visualization &amp; Analysis</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#label-default-of-credit-card"><i class="fa fa-check"></i><b>2.2.1</b> Label: Default of credit card</a></li>
<li class="chapter" data-level="2.2.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#categorical-variable"><i class="fa fa-check"></i><b>2.2.2</b> Categorical Variable</a></li>
<li class="chapter" data-level="2.2.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#numerical-variable"><i class="fa fa-check"></i><b>2.2.3</b> Numerical Variable</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#eda-conclusion"><i class="fa fa-check"></i><b>2.3</b> EDA Conclusion</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#feature-selection"><i class="fa fa-check"></i><b>2.3.1</b> Feature Selection</a></li>
<li class="chapter" data-level="2.3.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#data-wrangling-and-spliting"><i class="fa fa-check"></i><b>2.3.2</b> Data Wrangling and Spliting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>3</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="logistic-regression.html"><a href="logistic-regression.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="logistic-regression.html"><a href="logistic-regression.html#model-fitting"><i class="fa fa-check"></i><b>3.2</b> Model Fitting</a></li>
<li class="chapter" data-level="3.3" data-path="logistic-regression.html"><a href="logistic-regression.html#model-interpretation"><i class="fa fa-check"></i><b>3.3</b> Model Interpretation</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="logistic-regression.html"><a href="logistic-regression.html#model-information"><i class="fa fa-check"></i><b>3.3.1</b> Model Information</a></li>
<li class="chapter" data-level="3.3.2" data-path="logistic-regression.html"><a href="logistic-regression.html#shapley-values"><i class="fa fa-check"></i><b>3.3.2</b> Shapley Values</a></li>
<li class="chapter" data-level="3.3.3" data-path="logistic-regression.html"><a href="logistic-regression.html#partial-dependence-plots-pdp"><i class="fa fa-check"></i><b>3.3.3</b> Partial Dependence Plots (PDP)</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="logistic-regression.html"><a href="logistic-regression.html#model-evaluation"><i class="fa fa-check"></i><b>3.4</b> Model Evaluation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="decision-tree.html"><a href="decision-tree.html"><i class="fa fa-check"></i><b>4</b> Decision Tree</a>
<ul>
<li class="chapter" data-level="4.1" data-path="decision-tree.html"><a href="decision-tree.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="decision-tree.html"><a href="decision-tree.html#model-fitting-1"><i class="fa fa-check"></i><b>4.2</b> Model Fitting</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="decision-tree.html"><a href="decision-tree.html#complexity-parameter-cp"><i class="fa fa-check"></i><b>4.2.1</b> Complexity Parameter (cp)</a></li>
<li class="chapter" data-level="4.2.2" data-path="decision-tree.html"><a href="decision-tree.html#decision-tree-1"><i class="fa fa-check"></i><b>4.2.2</b> Decision Tree</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="decision-tree.html"><a href="decision-tree.html#model-interpreation"><i class="fa fa-check"></i><b>4.3</b> Model Interpreation</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="decision-tree.html"><a href="decision-tree.html#shapley-values-1"><i class="fa fa-check"></i><b>4.3.1</b> Shapley Values</a></li>
<li class="chapter" data-level="4.3.2" data-path="decision-tree.html"><a href="decision-tree.html#partial-dependence-plots-pdp-1"><i class="fa fa-check"></i><b>4.3.2</b> Partial Dependence Plots (PDP)</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="decision-tree.html"><a href="decision-tree.html#model-evaluation-1"><i class="fa fa-check"></i><b>4.4</b> Model Evaluation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="random-forest.html"><a href="random-forest.html"><i class="fa fa-check"></i><b>5</b> Random Forest</a>
<ul>
<li class="chapter" data-level="5.1" data-path="random-forest.html"><a href="random-forest.html#model-interpreation-1"><i class="fa fa-check"></i><b>5.1</b> Model Interpreation</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="random-forest.html"><a href="random-forest.html#shapley-values-2"><i class="fa fa-check"></i><b>5.1.1</b> Shapley Values</a></li>
<li class="chapter" data-level="5.1.2" data-path="random-forest.html"><a href="random-forest.html#partial-dependence-plots-pdp-2"><i class="fa fa-check"></i><b>5.1.2</b> Partial Dependence Plots (PDP)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="random-forest.html"><a href="random-forest.html#model-evaluation-2"><i class="fa fa-check"></i><b>5.2</b> Model Evaluation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="reflections.html"><a href="reflections.html"><i class="fa fa-check"></i><b>6</b> Reflections</a>
<ul>
<li class="chapter" data-level="6.1" data-path="reflections.html"><a href="reflections.html#model-comparison"><i class="fa fa-check"></i><b>6.1</b> Model Comparison</a></li>
<li class="chapter" data-level="6.2" data-path="reflections.html"><a href="reflections.html#main-takeaway"><i class="fa fa-check"></i><b>6.2</b> Main Takeaway</a></li>
<li class="chapter" data-level="6.3" data-path="reflections.html"><a href="reflections.html#limitaion"><i class="fa fa-check"></i><b>6.3</b> Limitaion</a></li>
<li class="chapter" data-level="6.4" data-path="reflections.html"><a href="reflections.html#future-work"><i class="fa fa-check"></i><b>6.4</b> Future Work</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Credit Crad Default Prediction</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="random-forest" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Random Forest<a href="random-forest.html#random-forest" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="model-interpreation-1" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Model Interpreation<a href="random-forest.html#model-interpreation-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Because the random forest is a black box model, we interpret it direactly by Shapley value and PDP.</p>
<div id="shapley-values-2" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Shapley Values<a href="random-forest.html#shapley-values-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="finalproj_files/figure-html/unnamed-chunk-51-1.png" width="768" />
The Shapley value is the average contribution of a feature value to the prediction in different coalitions. The plot above shows the mean absolute SHAP values of the random forest model we built, which represent the each variable’s impact to prediction. The feature importance distribution is concurrent with logistic regression model’s but different with decision tree’s, which states that the most importance feature is <code>PAY_1</code> and the second is <code>LIMIT_BAL</code>.</p>
</div>
<div id="partial-dependence-plots-pdp-2" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Partial Dependence Plots (PDP)<a href="random-forest.html#partial-dependence-plots-pdp-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="partial-dependence-plots-of-variable-pay_1-2" class="section level4 hasAnchor" number="5.1.2.1">
<h4><span class="header-section-number">5.1.2.1</span> Partial Dependence Plots of variable <code>PAY_1</code><a href="random-forest.html#partial-dependence-plots-of-variable-pay_1-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="finalproj_files/figure-html/unnamed-chunk-52-1.png" width="768" />
The random forest model’s distribution of level contribution of <code>PAY_1</code> are similar with the full decision tree model’s distribution of level contribution of <code>PAY_1</code>, which states that lower level of <code>PAY_1</code> (Indicating less delaying) have stronger impact to the prediction while other variable remain as constant. This information suggests that clients who have a history of less delaying in their payments (lower PAY_1 level) are less likely to default on their credit card payments. Because of the similarity, the paradoxical phenomenon that the full random forest model’s distribution of level contribution of <code>PAY_1</code> is completely opposite with the logistic regression model’s distribution of level contribution of <code>PAY_1</code> also exists.</p>
</div>
<div id="partial-dependence-plots-of-variable-limit_bal-1" class="section level4 hasAnchor" number="5.1.2.2">
<h4><span class="header-section-number">5.1.2.2</span> Partial Dependence Plots of variable <code>LIMIT_BAL</code><a href="random-forest.html#partial-dependence-plots-of-variable-limit_bal-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="finalproj_files/figure-html/unnamed-chunk-53-1.png" width="768" />
The PDP of Limit Balance shows that the relationship between the probability of default and Limit Balance is non-monotonic More specifically, the probability of default will initially increase, and then decrease, and finally remain stable when the limit balance increases. The assumption of this relationship between the probability of default and Limit Balance is all other variables remain constant.</p>
</div>
</div>
</div>
<div id="model-evaluation-2" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Model Evaluation<a href="random-forest.html#model-evaluation-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="finalproj_files/figure-html/unnamed-chunk-54-1.png" width="768" /></p>
<pre><code>## Accuracy:  0.7293333</code></pre>
<p>The plot above represents the Receiver Operating Characteristic (ROC) curves of the random forest model. The red line vertical to the X-axis represents the optimal threshold evaluated by the Youden index. Area Under the Curve (AUC), which measures the area under the Receiver Operating Characteristic (ROC) curve, is a metric used to evaluate the performance of a binary classification model. Given the AUC of model = 0.743 and the TPR at the optimal threshold, we can make a conclusion that the random forest model is good if we focus on accuracy and sensitivity. However, the random forest is a black box model, which means we cannot interpret it locally, but have to explain it using other models, such as Shapley values or partial dependence plots of variables. The lack of local interpretablilty is a representation of trade-off between interpretability and model performance.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="decision-tree.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reflections.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jasoonhh/Junhan-Huang-Srping-2023-IMLV-Final-Project-/edit/main/model3.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/jasoonhh/Junhan-Huang-Srping-2023-IMLV-Final-Project-/blob/main/model3.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
